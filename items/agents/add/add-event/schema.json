{
  "name": "add-event",
  "version": "v1",
  "io": {
    "inputs": {
      "required": ["user_input_event_link"],
      "optional": [
        "is_series",
        "user_input_event_start_date",
        "user_input_event_end_date",
        "venue_uid",
        "organizer_uid",
        "label_uids",
        "notes"
      ],
      "types": {
        "user_input_event_link": "https-url",
        "is_series": "enum[y|n]",
        "user_input_event_start_date": "date(YYYY-MM-DD)",
        "user_input_event_end_date": "date(YYYY-MM-DD)",
        "venue_uid": "uid(-venue)",
        "organizer_uid": "uid",
        "label_uids": "array[string]",
        "notes": "string"
      }
    },
    "derived": {
      "event_official_link": "confirmed from official site (domain-first)",
      "event_official_name": "extracted & sanitized per event-rules",
      "event_display_name": "title-cased display variant",
      "event_official_start_date": "confirmed from official schedule",
      "event_official_end_date": "confirmed when present",
      "event_uid": "computed from sanitized name & date policy; immutable",
      "yyyymm": "from start_date",
      "event_duration": "days between start and end when present",
      "event_current_status": "computed vs. today (America/New_York)",
      "event_estimated_next_start_date": "if annual"
    }
  },
  "preview_envelope": {
    "type": "PREVIEW",
    "lane": "yellow",
    "writes": [
      {
        "op": "add|update",
        "path": "index/events/<event_uid>.json",
        "payload": "<full event JSON object>"
      }
    ],
    "notes": ["unresolved relations or assumptions"]
  },
  "commit_contract": {
    "endpoint": "https://crt-b1434e13de34.herokuapp.com/items/commit",
    "method": "POST",
    "body": {
      "path": "index/events/<event_uid>.json",
      "json": "<full event JSON object>",
      "message": "feat(events): add <event_uid> (actor: agent)"
    },
    "json_only": true
  },
  "constraints": {
    "facts_only": true,
    "uids_immutable": true,
    "dates_format": "YYYY-MM-DD",
    "snake_case": true,
    "relations_must_resolve": true,
    "legs_inside_hub": true,
    "no_overlaps": true
  }
}
