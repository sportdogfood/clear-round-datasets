{
  "file": "final-schema.json",
  "version": "v2025-12-20-final-05",
  "street": "blog",
  "house": "cp:2",
  "purpose": [
    "Define the authoritative JSON shape for final_out objects created by srwrtr.",
    "Enforce schema consistency across all cp:2 lanes before commit and artifact export.",
    "Enable QA validators and downstream renderers to assert field presence and data types."
  ],
  "root_object": {
    "type": "object",
    "required": ["final_out"],
    "properties": {
      "final_out": {
        "type": "object",
        "required": [
          "job_id",
          "shape",
          "mode",
          "street",
          "house",
          "global_rules",
          "event_identity",
          "maps_anchor",
          "collection_body",
          "places_body"
        ],
        "properties": {
          "job_id": { "type": "string", "minLength": 1 },
          "shape": { "type": "string", "minLength": 1 },
          "mode": { "type": "string", "enum": ["live"] },
          "street": { "type": "string", "const": "blog" },
          "house": { "type": "string", "const": "cp:2" },
          "global_rules": { "type": "object" },
          "event_identity": {
            "type": "object",
            "required": [
              "event_name",
              "event_acronym",
              "venue_name",
              "city",
              "state",
              "season_label",
              "rating_string",
              "rider_caliber"
            ],
            "properties": {
              "event_name": { "type": "string" },
              "event_acronym": { "type": "string" },
              "venue_name": { "type": "string" },
              "city": { "type": "string" },
              "state": { "type": "string" },
              "season_label": { "type": "string" },
              "rating_string": { "type": "string" },
              "rider_caliber": { "type": "string" }
            },
            "additionalProperties": false
          },
          "maps_anchor": {
            "type": "object",
            "required": ["place_id", "lat", "lng"],
            "properties": {
              "place_id": { "type": "string" },
              "lat": { "type": ["number", "null"] },
              "lng": { "type": ["number", "null"] }
            },
            "additionalProperties": false
          },
          "collection_body": {
            "type": "object",
            "required": ["paragraph_1", "paragraph_2"],
            "properties": {
              "paragraph_1": { "type": "string" },
              "paragraph_2": { "type": "string" }
            },
            "additionalProperties": false
          },
          "places_body": {
            "type": "object",
            "required": [
              "stay_paragraph",
              "dine_paragraph",
              "essentials_paragraph",
              "locale_paragraph",
              "outro_paragraph"
            ],
            "properties": {
              "stay_paragraph": { "type": "string" },
              "dine_paragraph": { "type": "string" },
              "essentials_paragraph": { "type": "string" },
              "locale_paragraph": { "type": "string" },
              "outro_paragraph": { "type": "string" }
            },
            "additionalProperties": false
          }
        },
        "additionalProperties": false
      }
    }
  },
  "validation_rules": {
    "strings_must_be_ascii": true,
    "no_literal_could_not_verify": true,
    "all_required_keys_present": true,
    "mode_must_be_live": true,
    "street_const_must_match_pipeline": true,
    "house_const_must_match_pipeline": true
  },
  "integration_expectations": {
    "upstream_inputs": ["stitched_out"],
    "produced_by": "srwrtr",
    "consumed_by": ["commit"],
    "artifact_targets": ["docs_finals", "docs_logs"],
    "schema_invariants": [
      "No null strings",
      "No missing paragraph fields",
      "Stable ordering of keys"
    ]
  }
}
