Purpose: Structure Runner scaffolds blog files. It never edits post body JSON.

TRIGGER CONTRACT (message JSON):
{
  "add_post": "<content JSON URL>",
  "assets_uri": "<assets JSON URL>",
  "canonical_base": "https://blog.clearroundtravel.com",
  "allow_urls": ["<event.json>","<venue.json>","<official site>"]
}
Notes:
- Only fetch HTTPS URLs in allow_urls plus the two trigger URLs.
- canonical_base defaults to https://blog.clearroundtravel.com.

PATH INVARIANTS
- Storage: docs/blogs/{venue}-blogs-{year}/{slug}/
- slug = {venue}-blog-{YYYY-MM-DD} (date from content filename)
- Post folder contains:
  - index.html (generated from templates/blog.index.html.tmpl)
  - <verbatim post JSON filename> (unchanged)

MANIFEST UPSERT
- File: docs/blogs/manifest.json (array)
- Key: slug
- Upsert fields:
  slug, title, date, year, month_num, month_name, season,
  path, json, image, venue, city, state, country,
  tags[], rating_uids[], rating_labels[], sanctioning, fei_level, usef_premier, discipline[]
- title from content.seo.section_title fallback seo.open_graph_title
- image from assets.hero.src
- path format: /blogs/{venue}-blogs-{year}/{slug}/

RATINGS & DISCIPLINE
- If event.rating_uids present: map to sanctioning/levels, add human labels to tags.
- If rating_uids missing/empty: omit all rating fields.
- Discipline: include only if non-empty in event data; otherwise omit.

ASSETS
- Accept hero/stay/dine/locale/essentials keys with {src,alt}.
- Require site-root absolute src paths (/assets/images/...).
- Fallbacks when missing:
  hero=/assets/images/hero-placeholder.jpg
  stay=/assets/images/stay-placeholder.jpg
  dine=/assets/images/dine-placeholder.jpg
  locale=/assets/images/place-placeholder.jpg
- Preserve provided alt; default "placeholder" if missing.

PARAGRAPH MARKDOWN
- Use helper at /assets/js/md.js.
- Convert inline Markdown links `[label](url)` to `<a>` with `target="_blank"` and `rel="noopener nofollow external"`.
- Escape all HTML before link conversion; allow only anchors.
- Apply only to these fields:
  hello.intro, hello.outro,
  stay.paragraph,
  dine.overview, dine.am, dine.dinner,
  locale.paragraph,
  essentials.paragraph.
- Lists remain in items[] with separate name, url, alt.

DINE FIELDS
- Render three paragraphs with headings in this order:
  1) Overview → from dine.overview
  2) Breakfast → from dine.am
  3) Dinner → from dine.dinner

INTERACTIVES
- Recent: newest 4 by date.
- Next/Prev: neighbors around current slug in date-desc order.
- Reels: month, season, venue filters from manifest.

OUTPUTS ON add_post
1) docs/blogs/{venue}-blogs-{year}/{slug}/index.html
2) docs/blogs/manifest.json (upsert)
3) docs/blogs/index.html
4) docs/blogs/{year}/index.html
5) docs/blogs/rss.xml
6) docs/sitemap.xml

MODES
- remove_post: delete slug folder, remove manifest entry, rebuild indices/feeds/sitemap
- rebuild_all: rebuild indices/feeds/sitemap from manifest only

VALIDATION
- GET content and assets URIs → 200 + JSON parse
- Secondary fetches restricted to allow_urls
- Manifest must validate against manifest.schema.json

IDEMPOTENCE
- Deterministic output; avoid variable timestamps
- Atomic replace of generated files

RETURN PAYLOAD
- JSON with "writes", "deletes", "trace" arrays listing all operations
